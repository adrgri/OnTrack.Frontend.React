import{j as e,B as w,r as c,k as O}from"./index-bec6d2e9.js";import{M as S}from"./MainLayout-3bada8f4.js";import{B as F}from"./BoardNavigation-a93660b6.js";import{u as g,S as C,I as v,a as k,b as A,G as E,C as T,M,c as W,D as z,O as L,d as R,e as G,A as N}from"./ActionButtons-23b768fd.js";import{D as V,C as q,a as Q}from"./CloseButton-0a227649.js";import{u as U}from"./formik.esm-cdd0f13f.js";import{D as Y}from"./DialogTitle-a68dff45.js";import{T as p,c as Z}from"./Logo-684fc345.js";import{I as $}from"./IconButton-9f70b72d.js";import{G as n}from"./Grid-617021ec.js";import"./Avatar-87e30145.js";const H="/OnTrack.Frontend.React/assets/TasksIcon-00eb2292.svg",J="/OnTrack.Frontend.React/assets/SearchIcon-bdadde32.svg";function P({isOpen:t,handleClose:a,project:s,mode:o}){const{addProject:m,updateProject:u}=g(),i=U({initialValues:{title:(s==null?void 0:s.title)||"",description:(s==null?void 0:s.description)||"",memberIds:["8ea90da1-7a64-4817-9208-45b5ad734bc3"]},onSubmit:async(l,{setSubmitting:x})=>{const r={...s,title:l.title,description:l.description,memberIds:["8ea90da1-7a64-4817-9208-45b5ad734bc3"]};try{o==="add"?(await m(r),console.log("Adding project:",r)):o==="edit"&&(s!=null&&s.id)&&(console.log("Project updated:",r),await u(s.id,r)),a()}catch(h){console.error("Error submitting the project:",h)}finally{x(!1)}},enableReinitialize:!0});return e.jsxs(V,{fullWidth:!0,maxWidth:"md",open:t,onClose:a,PaperProps:{sx:{overflowY:"auto",maxWidth:"500px"}},children:[e.jsx(Y,{sx:{textAlign:"center",fontWeight:600,fontSize:"17px",color:"#5F5B5B",mt:2},children:o==="add"?"Dodaj projekt":"Edytuj projekt"}),e.jsx(q,{onClick:a,right:20,top:20}),e.jsxs("form",{onSubmit:i.handleSubmit,children:[e.jsxs(Q,{sx:{paddingBottom:12},children:[e.jsx(p,{variant:"body1",sx:{color:"#5F5B5B",fontWeight:600},children:"Nazwa projektu"}),e.jsx(C,{fullWidth:!0,variant:"filled",name:"title",value:i.values.title,onChange:i.handleChange,placeholder:"Wpisz nazwe projektu",sx:{width:300}}),e.jsx(p,{mt:2,variant:"body1",sx:{color:"#5F5B5B",fontWeight:600},children:"Członkowie"}),e.jsx(C,{fullWidth:!0,variant:"filled",name:"memberIds",value:i.values.memberIds,onChange:i.handleChange,placeholder:"Wyszukaj członków",sx:{width:300},InputProps:{endAdornment:e.jsx(v,{position:"end",children:e.jsx("img",{src:J,alt:"search"})})}})]}),e.jsxs(w,{sx:{display:"flex",justifyContent:"flex-end",mt:2,position:"absolute",bottom:36,right:26},children:[e.jsx(k,{type:"submit",variant:"contained",sx:{marginRight:2},children:"Zapisz"}),e.jsx(k,{type:"button",variant:"contained",sx:{backgroundColor:"#5E5F7D"},onClick:a,children:"Anuluj"})]})]})]})}const K=({project:t,isEditClicked:a})=>{const[s,o]=c.useState(!1),[m,u]=c.useState(null),[i,l]=c.useState(!1),x=O(),{requestDelete:r,confirmDelete:h,isConfirmOpen:d,closeModal:f}=A(),y=b=>{b.stopPropagation(),u(b.currentTarget),o(!0)},j=c.useCallback(()=>{t&&r({id:t.id,type:"project"},g.getState().deleteProject)},[t,r]),I=c.useCallback(()=>{l(!0),o(!1)},[]),D=()=>{l(!1)},B=()=>{x(`/projects/${t==null?void 0:t.id}/tasks`)};return e.jsxs(e.Fragment,{children:[e.jsxs(E,{onClick:B,sx:{width:"400px",position:"relative"},children:[e.jsx($,{"aria-label":"more options",sx:{position:"absolute",top:8,right:8},onClick:a?j:y,children:a?e.jsx("img",{src:T,alt:"Usuń"}):e.jsx("img",{src:M,alt:"Więcej opcji"})}),e.jsxs(n,{container:!0,direction:"row",spacing:2,alignItems:"center",justifyContent:"space-between",children:[e.jsxs(n,{item:!0,xs:7,children:[e.jsx(n,{item:!0,xs:12,mb:2,alignItems:"center",children:e.jsx(p,{children:t==null?void 0:t.title})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(W,{spacing:2,mb:2,sx:{"& > :not(style) ~ :not(style)":{mt:0}}})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(n,{item:!0,xs:!0,children:(t==null?void 0:t.dueDate)&&e.jsx(z,{date:t.dueDate})})})]}),e.jsxs(n,{item:!0,alignItems:"center",justifyContent:"space-between",xs:4,children:[e.jsx(n,{item:!0,xs:!0,container:!0,justifyContent:"center"}),e.jsxs(n,{item:!0,xs:12,mt:2,container:!0,alignItems:"center",justifyContent:"center",children:[e.jsx("img",{src:H,alt:"Tasks"}),e.jsx(p,{variant:"subtitle2",color:"text.secondary",ml:1})]})]}),e.jsx(n,{})]}),e.jsx(L,{open:s,anchorEl:m,onClose:()=>o(!1),onEdit:I,onDelete:j}),e.jsx(R,{isOpen:d,onDeleteConfirm:h,onClose:f,itemName:t==null?void 0:t.title,itemType:"project"})]}),e.jsx(P,{isOpen:i,handleClose:D,project:t,mode:"edit"})]})};function X(){const t=Z(),a=G(t.breakpoints.down("md")),[s,o]=c.useState(!1),[m,u]=c.useState(!1),{projects:i,fetchProjects:l}=g();console.log("Projects:",i),c.useEffect(()=>{l()},[l]);const x=d=>{d.stopPropagation(),o(f=>!f),console.log("Edit action triggered")};function r(){u(!1)}const h=d=>{d.stopPropagation(),u(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs(n,{container:!0,spacing:2,alignItems:"baseline",justifyContent:"space-between",children:[e.jsx(n,{item:!0,children:e.jsx(F,{leftButtonLabel:"Projekty",rightButtonLabel:"Tablica",leftButtonLink:"/projects",rightButtonLink:"/tablica"})}),e.jsx(N,{handleAdd:h,handleEdit:x,children:"Projekt"})]}),e.jsx(n,{container:!0,justifyContent:"space-between",alignItems:"center",sx:{flexDirection:a?"column":"row",[t.breakpoints.up("md")]:{alignItems:"flex-start"},[t.breakpoints.down("md")]:{alignItems:"center"}},children:i.map(d=>e.jsx(K,{project:d,handleTaskClick:()=>{},isEditClicked:s},d.id))}),e.jsx(P,{isOpen:m,handleClose:r,mode:"add"})]})}const ce=()=>e.jsx(e.Fragment,{children:e.jsx(S,{children:e.jsx(X,{})})});export{ce as default};
